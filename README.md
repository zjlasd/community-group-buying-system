# 社区团购团长分销与订单汇总系统

> 太原理工大学毕业设计项目  
> 学号: 2022005566 | 学生: 张建亮 | 专业方向: 人工智能

## 📖 项目简介

本系统是一个面向社区团购业务的管理后台系统(B端),为平台管理员和团长提供订单管理、佣金结算、数据统计等核心功能。通过自动化订单汇总、佣金计算和数据可视化分析,大幅提升团长管理效率和平台运营质量。

### 核心功能
- 🔐 **用户认证**: 基于JWT的身份认证与权限控制
- 📊 **数据看板**: 运营数据统计与ECharts可视化图表
- 📦 **订单管理**: 订单列表、详情查看、一键导出配送清单
- 👥 **团长管理**: 团长信息管理、业绩统计与排名
- 💰 **佣金管理**: 自动佣金计算、提现审核、收益统计
- ✅ **订单核销**: 扫码核销、自动结算佣金
- 🛍️ **商品管理**: 商品CRUD、库存管理、上架/下架
- 🏘️ **社区管理**: 社区信息管理、团长分配
- 👤 **客户管理**: 客户信息管理、标签分类

## 🛠️ 技术栈

### 前端技术
- **框架**: Vue 3.5.28 + TypeScript 5.9
- **构建工具**: Vite 7.3.1
- **UI组件库**: Element Plus 2.13.2
- **状态管理**: Pinia 3.0.4
- **路由管理**: Vue Router 5.0.2
- **数据可视化**: ECharts 6.0.0
- **Excel导出**: xlsx 0.18.5
- **HTTP请求**: Axios 1.13.5

### 后端技术
- **框架**: Node.js + Express.js 4.18.2
- **数据库**: MySQL 8.0
- **ORM**: Sequelize 6.33.0
- **身份认证**: JWT (jsonwebtoken 9.0.2)
- **密码加密**: bcrypt 5.1.1
- **日志管理**: winston 3.10.0
- **Excel生成**: exceljs 4.3.0

## 📁 项目结构

```
.
├── frontend/                      # 前端项目(Vue3 + TypeScript)
│   ├── src/
│   │   ├── views/                # 页面组件
│   │   │   ├── Login/           # 登录页
│   │   │   ├── Dashboard/       # 管理员-数据看板
│   │   │   ├── Order/           # 管理员-订单管理
│   │   │   ├── ProductManage/   # 管理员-商品管理
│   │   │   ├── Leader/          # 管理员-团长管理
│   │   │   ├── Commission/      # 管理员-佣金管理
│   │   │   ├── Community/       # 管理员-社区管理
│   │   │   ├── LeaderCenter/    # 团长-个人中心
│   │   │   ├── MyOrders/        # 团长-我的订单
│   │   │   ├── Products/        # 团长-可推广商品
│   │   │   ├── Customers/       # 团长-客户管理
│   │   │   └── Withdraw/        # 团长-提现管理
│   │   ├── components/          # 公共组件
│   │   │   ├── Layout/         # 主布局组件
│   │   │   └── ...
│   │   ├── router/              # 路由配置
│   │   ├── stores/              # Pinia状态管理
│   │   ├── api/                 # API接口封装
│   │   ├── utils/               # 工具函数
│   │   └── main.ts             # 入口文件
│   └── package.json
│
├── backend/                      # 后端项目(Node.js + Express)
│   ├── src/
│   │   ├── routes/              # 路由定义
│   │   ├── controllers/         # 控制器(业务逻辑)
│   │   ├── models/              # Sequelize数据模型
│   │   ├── middleware/          # 中间件(JWT认证、权限验证)
│   │   ├── services/            # 业务服务层
│   │   ├── utils/               # 工具函数
│   │   ├── config/              # 配置文件
│   │   ├── scripts/             # 数据库初始化脚本
│   │   └── app.js              # 应用入口
│   └── package.json
│
├── 太原理工大学软件学院本科毕业论文开题报告-精简版.md  # 开题报告
├── pnpm-workspace.yaml          # Monorepo工作区配置
└── package.json                 # 根目录配置
```

## 🚀 快速开始

### 环境要求
- Node.js >= 20.19.0 或 >= 22.12.0
- pnpm >= 8.15.6
- MySQL >= 8.0

### 安装依赖
```bash
# 安装根目录和所有子项目依赖
pnpm install
```

### 数据库配置

1. 创建数据库
```sql
CREATE DATABASE community_group_buying CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

2. 配置环境变量
```bash
# 在backend目录下创建.env文件
cd backend
cp .env.example .env

# 编辑.env文件,配置数据库连接信息
DB_HOST=localhost
DB_PORT=3306
DB_USER=root
DB_PASSWORD=your_password
DB_NAME=community_group_buying
JWT_SECRET=your_jwt_secret
```

3. 初始化数据库
```bash
# 创建数据表
pnpm run init-db

# 生成模拟数据(可选)
pnpm run seed
```

### 运行项目
```bash
# 在项目根目录运行

# 仅运行前端
pnpm dev:frontend

# 仅运行后端
pnpm dev:backend

# 同时运行前后端(推荐)
pnpm dev
```

### 访问系统
- **前端地址**: http://localhost:5173
- **后端地址**: http://localhost:3000

### 测试账号
```
管理员账号: admin / 123456
团长账号:   leader / 123456
```

**角色权限说明**:
- **管理员(admin)**: 
  - 数据看板(全平台运营数据统计)
  - 订单管理(所有订单、导出配送清单)
  - 商品管理(商品CRUD、上架/下架)
  - 团长管理(团长CRUD、业绩统计)
  - 佣金管理(平台佣金统计、提现审核)
  - 社区管理(社区信息、团长分配)

- **团长(leader)**: 
  - 个人中心(佣金收益、业绩统计、订单趋势)
  - 我的订单(订单列表、确认收货、扫码核销)
  - 可推广商品(商品列表、预估佣金)
  - 客户管理(客户列表、标签管理)
  - 提现管理(提现申请、提现记录)

## 📊 业务流程

社区团购采用"预售+自提"模式,业务周期为7天:

```
第1-3天(预售期) → 团长推广商品 → 消费者下单 → 订单状态: 待成团
      ↓
第4天(截单日)   → 平台汇总订单 → 生成配送清单 → 订单状态: 待配送
      ↓
第5天(配送日)   → 供应商统一配送到团长 → 团长确认收货 → 订单状态: 待自提
      ↓
第6-7天(自提期) → 消费者到自提点取货 → 团长扫码核销 → 订单状态: 已完成
                                          ↓
                                    自动计算佣金
                                          ↓
                                    更新团长账户余额
      ↓
月底(结算期)    → 团长查看佣金明细 → 申请提现 → 管理员审核 → 打款
```

### 角色定位
- **平台方**: 提供商品、订单管理、数据统计、佣金结算
- **团长**: 社区"销售代理人"和"自提点负责人"(不负责配送)
  - 社区推广、自提点管理、客户服务、订单核销
  - 收入来源: 订单金额的10%-15%佣金
- **供应商**: 负责商品仓储、统一配送到团长处
- **消费者**: 移动端下单、团长处自提(本项目不实现C端)

## 🎯 核心价值

本系统解决社区团购团长管理的三大痛点:

### 1. 配送清单生成自动化
- **痛点**: 团长每天手工统计次日配送清单,平均耗时2-3小时
- **解决方案**: 一键导出配送清单,系统自动按商品维度汇总数量
- **效果**: 配送清单生成时间从2-3小时降至<5秒,效率提升360倍

### 2. 佣金计算自动化
- **痛点**: 团长佣金需要手工计算,容易出错,约30%团长遇到过纠纷
- **解决方案**: 订单核销时自动计算佣金,实时到账
- **效果**: 佣金计算准确率100%,减少平台与团长之间的纠纷

### 3. 订单核销智能化
- **痛点**: 消费者取货时手工登记核销信息,平均耗时2-3分钟/单
- **解决方案**: 扫码核销功能,自动验证核销码并更新订单状态
- **效果**: 核销时长从2-3分钟降至<10秒,减少客户排队等待

### 4. 数据统计可视化
- **痛点**: 团长缺乏系统化的业绩统计工具
- **解决方案**: 基于ECharts的数据可视化分析(订单趋势、销售额、佣金收益)
- **效果**: 团长和平台管理者实时掌握业务动态,支持数据驱动决策

## 💾 数据库设计

系统设计8张核心数据表:

### 核心业务表
1. **users**(用户表): 用户名、密码、角色(管理员/团长)
2. **leaders**(团长表): 姓名、手机、社区、佣金比例、账户余额、累计佣金
3. **communities**(社区表): 社区名称、详细地址、区域
4. **products**(商品表): 商品名称、分类、价格、库存、佣金比例、状态
5. **orders**(订单表): 订单号、团长、客户、金额、状态、核销码
6. **order_items**(订单明细表): 订单、商品、数量、单价
7. **commissions**(佣金记录表): 团长、订单、金额、类型、状态
8. **withdrawals**(提现申请表): 团长、金额、方式、审核状态

### 数据库初始化
```bash
# 创建数据表
pnpm run init-db

# 生成模拟数据
pnpm run seed
```

生成的模拟数据:
- 2个用户(1个管理员、1个团长)
- 10个团长
- 5个社区
- 20种商品
- 350条订单(7天数据)
- 佣金记录和提现申请

## 🔧 核心技术实现

### 1. 佣金自动计算
```javascript
// 订单核销触发佣金结算
佣金金额 = 订单总金额 × 团长佣金比例

// 订单完成后自动结算
async settleCommission(orderId) {
  // 1. 计算佣金金额
  // 2. 更新订单佣金状态为已结算
  // 3. 增加团长账户余额
  // 4. 更新团长累计佣金
  // 5. 插入佣金记录
  // 6. 使用数据库事务保证一致性
}
```

### 2. 配送清单生成
```javascript
// 1. 查询"待配送"状态订单
// 2. 按商品维度汇总数量(使用Map,时间复杂度O(n))
// 3. 使用exceljs库生成Excel
// 4. 前端触发文件下载
// 处理1000条订单<5秒
```

### 3. 权限控制
- **后端**: JWT认证 + 角色权限中间件
- **前端**: 路由守卫 + 动态路由 + 指令级权限

## 📄 项目文档

- [开题报告](./太原理工大学软件学院本科毕业论文开题报告-精简版.md) - 约7500字,包含选题意义、研究现状、主要研究内容等

## 🎓 项目特色

1. **垂直化解决方案**: 针对社区团购团长管理场景,解决实际业务痛点
2. **技术栈主流**: Vue 3 + Node.js + MySQL,技术成熟易维护
3. **权限控制完善**: 基于角色的访问控制(RBAC),前后端双重验证
4. **性能优化**: 数据库索引、分页查询、ECharts懒加载
5. **用户体验**: Element Plus UI、响应式布局、操作反馈

## 📧 联系方式

- **学号**: 2022005566
- **姓名**: 张建亮
- **专业方向**: 人工智能
- **学校**: 太原理工大学软件学院

## 📜 License

MIT License - 本项目仅用于学习和毕业设计,不得用于商业用途
